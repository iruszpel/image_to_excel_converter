(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,n){e.exports=n(22)},17:function(e,t,n){},18:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(2),i=n.n(r),l=(n(17),n(3)),c=n(4),A=n(9),g=n(5),s=n(10),u=(n(18),n(6)),d=n(7),h=n.n(d),w=n(8),m=n.n(w),p=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(A.a)(this,Object(g.a)(t).call(this,e))).rgbToHex=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},n.fullColorHex=function(e,t,o,a){var r=n.rgbToHex(e),i=n.rgbToHex(t),l=n.rgbToHex(o);return n.rgbToHex(a)+r+i+l},n.getColorAtXY=function(e,t,o){var a=4*(t*o.width+e),r=o.data[a],i=o.data[a+1],l=o.data[a+2],c=o.data[a+3];return n.fullColorHex(r,i,l,c)},n.addCellToSheet=function(e,t,n){e[t]=n;var o=window.XLSX.utils.decode_range(e["!ref"]),a=window.XLSX.utils.decode_cell(t);o.s.c>a.c&&(o.s.c=a.c),o.s.r>a.r&&(o.s.r=a.r),o.e.c<a.c&&(o.e.c=a.c),o.e.r<a.r&&(o.e.r=a.r),e["!ref"]=window.XLSX.utils.encode_range(o)},n.handleUpload=function(e){n.convertToExcel(e)},n.handleKeyDown=function(e){13===e.keyCode&&n.downloadImage(n.state.URL)},n.onInput=function(e){n.setState({URL:e.target.value})},n.toDataURL=function(e,t,o){n.setState({status:"Downloading..."});var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e,n=document.createElement("CANVAS"),a=n.getContext("2d");n.height=this.naturalHeight,n.width=this.naturalWidth,a.drawImage(this,0,0),e=n.toDataURL(o),t(e)},a.src="https://cors-anywhere.herokuapp.com/".concat(e),(a.complete||void 0===a.complete)&&(a.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",a.src=e)},n.downloadImage=function(e){return n.toDataURL(e,function(e){n.convertToExcel(e)},"image/png")},n.convertToExcel=function(e){var t=new Image;t.src=e,t.onload=function(){n.setState({status:"Converting..."});var e=document.createElement("canvas"),o=t.height,a=t.width;t.height>150&&(o=150,a=Math.floor(o/t.height*t.width)),e.width=a,e.height=o;var r=e.getContext("2d");r.drawImage(t,0,0,a,o);var i=r.getImageData(0,0,e.width,e.height),l=window.XLSX,c=new XMLHttpRequest;c.open("GET","blank.xlsx",!0),c.responseType="arraybuffer",c.onload=function(t){for(var o=c.response,a=new Uint8Array(o),r=[],A=0;A!==a.length;++A)r[A]=String.fromCharCode(a[A]);for(var g=r.join(""),s=l.read(g,{type:"binary"}),u=s.Sheets[s.SheetNames[0]],d=0;d<e.height;++d)for(var w=0;w<e.width;++w){var m=l.utils.encode_cell({c:w,r:d});n.addCellToSheet(u,m,{t:"s",v:"",s:{fill:{bgColor:{rgb:n.getColorAtXY(w,d,i)},fgColor:{rgb:n.getColorAtXY(w,d,i)}}}})}var p=Array(e.width).fill({wpx:16}),b=Array(e.height).fill({hpx:16});u["!rows"]=b,u["!cols"]=p;var E=l.write(s,{bookType:"xlsx",bookSST:!1,type:"binary"});h()(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!==e.length;++o)n[o]=255&e.charCodeAt(o);return t}(E)],{type:""}),"out.xlsx"),n.setState({status:null})},c.send()}},n.handleUploadError=function(e){alert(e)},n.state={converting:!1},n}return Object(s.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown,!1)}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"Title"},"Image to Excel file converter"),a.a.createElement("p",null,"Enter URL to image"),a.a.createElement("input",{onInput:this.onInput,type:"url",name:"url",className:"imageUrl",placeholder:"https://example.com/Cool_Image.jpg"}),a.a.createElement("p",null,"Or"),a.a.createElement(u.ImagePicker,{extensions:["jpg","jpeg","png","webp","bmp"],onChange:this.handleUpload,dims:{minWidth:1,maxWidth:3840,minHeight:1,maxHeight:2160},onError:this.handleUploadError},a.a.createElement("div",{className:"Upload"},"Choose image")),a.a.createElement("p",{className:"Note"},a.a.createElement("b",null,"Note:")," Images with higher resolution will be resized. Also you may want to adjust the cell width and height in the output document."),this.state.status&&a.a.createElement("p",null,this.state.status),a.a.createElement("a",{href:"https://github.com/lopogo59/image_to_excel_converter",className:"Source"},a.a.createElement("img",{className:"sourceIcon",src:m.a}),"Source code"))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},8:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyRTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyRjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJDOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJEOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+FYrpWAAABrNJREFUeNrkW2ls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"}},[[11,1,2]]]);
//# sourceMappingURL=main.140712bf.chunk.js.map